{% extends "base.html" %}
{% block content %}

<h2 class="page-title"><i class="fa-solid fa-gem"></i> Tableau de bord</h2>
<p class="hint">Bienvenue, {{ user.full_name }} ✨</p>

<div class="card ranked-card quick-links">
  <h3>Accès Rapide</h3>
  <div class="link-buttons">
    <a href="{{ request.url_for('employees_page') }}" class="btn btn-gold"><i class="fa-solid fa-users"></i> Employés</a>
    <a href="{{ request.url_for('attendance_page') }}" class="btn btn-secondary"><i class="fa-regular fa-calendar-xmark"></i> Absences</a>
    <a href="{{ request.url_for('deposits_page') }}" class="btn btn-secondary"><i class="fa-solid fa-money-bill-transfer"></i> Avances</a>
    <a href="{{ request.url_for('leaves_page') }}" class="btn btn-secondary"><i class="fa-solid fa-umbrella-beach"></i> Congés</a>
    <a href="{{ request.url_for('pay_employee_page') }}" class="btn btn-success"><i class="fa-solid fa-hand-holding-dollar"></i> Payer</a>
  </div>
</div>

{% if user.role == 'admin' %}
<div class="table-card ranked-card">
  <h3>Activité Récente (Admin)</h3>
  {% if activity %}
  <div class="table-responsive">
    <table>
      <thead>
        <tr><th>Quand</th><th>Action</th><th>Entité</th><th>Détails</th></tr>
      </thead>
      <tbody>
        {% for a in activity %}
        <tr>
          <td class="timestamp">{{ a.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
          <td><span class="badge action-{{ a.action }}">{{ a.action }}</span></td>
          <td>{{ a.entity }}{% if a.entity_id %} #{{ a.entity_id }}{% endif %}</td>
          <td class="details">{{ a.details or '-' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="no-data">Aucune activité récente à afficher.</p>
  {% endif %}
</div>
{% endif %}
{% endblock %}
